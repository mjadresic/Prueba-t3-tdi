"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/etl";
exports.ids = ["pages/api/etl"];
exports.modules = {

/***/ "@google-cloud/storage":
/*!****************************************!*\
  !*** external "@google-cloud/storage" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@google-cloud/storage");

/***/ }),

/***/ "csv-parse/sync":
/*!*********************************!*\
  !*** external "csv-parse/sync" ***!
  \*********************************/
/***/ ((module) => {

module.exports = import("csv-parse/sync");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./config.js":
/*!*******************!*\
  !*** ./config.js ***!
  \*******************/
/***/ ((module) => {

eval("\nmodule.exports = {\n    BUCKET_NAME: \"2024-1-tarea-3\" || 0,\n    GOOGLE_APPLICATION_CREDENTIALS: process.env.GOOGLE_APPLICATION_CREDENTIALS || './taller-integracion-310700-41f361102b8b.json'\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9jb25maWcuanMuanMiLCJtYXBwaW5ncyI6IjtBQUFBQSxNQUFNLENBQUNDLE9BQU8sR0FBRyxDQUFDO0lBQ2hCQyxXQUFXLEVBQUVDLGdCQUF1QixJQUFJLENBQWdCO0lBQ3hERSw4QkFBOEIsRUFBRUYsT0FBTyxDQUFDQyxHQUFHLENBQUNDLDhCQUE4QixJQUFJLENBQStDO0FBQy9ILENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS1kYXNoYm9hcmQvLi9jb25maWcuanM/YzJiMyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHtcclxuICBCVUNLRVRfTkFNRTogcHJvY2Vzcy5lbnYuQlVDS0VUX05BTUUgfHwgJzIwMjQtMS10YXJlYS0zJyxcclxuICBHT09HTEVfQVBQTElDQVRJT05fQ1JFREVOVElBTFM6IHByb2Nlc3MuZW52LkdPT0dMRV9BUFBMSUNBVElPTl9DUkVERU5USUFMUyB8fCAnLi90YWxsZXItaW50ZWdyYWNpb24tMzEwNzAwLTQxZjM2MTEwMmI4Yi5qc29uJyxcclxufTtcclxuIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJCVUNLRVRfTkFNRSIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQVBQTElDQVRJT05fQ1JFREVOVElBTFMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./config.js\n");

/***/ }),

/***/ "(api)/./pages/api/etl.js":
/*!**************************!*\
  !*** ./pages/api/etl.js ***!
  \**************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _google_cloud_storage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google-cloud/storage */ \"@google-cloud/storage\");\n/* harmony import */ var _google_cloud_storage__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_google_cloud_storage__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var csv_parse_sync__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! csv-parse/sync */ \"csv-parse/sync\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../config */ \"(api)/./config.js\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_config__WEBPACK_IMPORTED_MODULE_4__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([csv_parse_sync__WEBPACK_IMPORTED_MODULE_1__]);\ncsv_parse_sync__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\nasync function handler(req, res) {\n    console.log('Starting ETL and data compilation process');\n    let storage;\n    if (false) {} else {\n        // En entorno local, leer credenciales desde el archivo\n        const credentialsPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), (_config__WEBPACK_IMPORTED_MODULE_4___default().GOOGLE_APPLICATION_CREDENTIALS));\n        if (!fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(credentialsPath)) {\n            console.error(`Credentials file not found at ${credentialsPath}`);\n            return res.status(500).json({\n                error: `Credentials file not found at ${credentialsPath}`\n            });\n        }\n        storage = new _google_cloud_storage__WEBPACK_IMPORTED_MODULE_0__.Storage({\n            keyFilename: credentialsPath\n        });\n    }\n    const bucket = storage.bucket((_config__WEBPACK_IMPORTED_MODULE_4___default().BUCKET_NAME));\n    const products = [];\n    const ordersByYear = {};\n    try {\n        console.log('Attempting to retrieve files from bucket');\n        const [files] = await bucket.getFiles();\n        console.log('Files retrieved from bucket:', files.map((file)=>file.name\n        ));\n        console.log(\"Downloading...\");\n        for (const file1 of files){\n            const [data] = await file1.download();\n            if (file1.name.includes('products')) {\n                const productData = JSON.parse(data.toString());\n                products.push(...productData);\n                console.log(`File ${file1.name} downloaded`);\n            } else if (file1.name.includes('orders')) {\n                const yearMatch = file1.name.match(/orders\\/(\\d{4})\\//);\n                if (yearMatch) {\n                    const year = yearMatch[1];\n                    if (!ordersByYear[year]) {\n                        ordersByYear[year] = [];\n                    }\n                    try {\n                        const parsedData = (0,csv_parse_sync__WEBPACK_IMPORTED_MODULE_1__.parse)(data.toString(), {\n                            columns: true,\n                            skip_empty_lines: true,\n                            delimiter: ';'\n                        });\n                        ordersByYear[year].push(...parsedData.map((record, index)=>{\n                            return {\n                                order_id: record.order_id || `missing_order_id_${index + 1}`,\n                                customer_id: record.customer_id || `missing_customer_id_${index + 1}`,\n                                quantity: record.quantity ? parseInt(record.quantity.replace(',', '.'), 10) : 1,\n                                price_MRP: record.price_MRP ? parseFloat(record.price_MRP.replace(',', '.')) : 0,\n                                payment: record.payment ? parseFloat(record.payment.replace(',', '.')) : 0,\n                                timestamp: record.timestamp || '1970-01-01 00:00:00',\n                                rating: record.rating ? parseInt(record.rating, 10) : 0,\n                                product_category: record.product_category || 'unknown',\n                                product_id: record.product_id || 'NULL',\n                                payment_type: record.payment_type || 'unknown',\n                                order_status: record.order_status || 'unknown',\n                                product_weight_g: record.product_weight_g ? parseFloat(record.product_weight_g.replace(',', '.')) : 0,\n                                product_length_cm: record.product_length_cm ? parseFloat(record.product_length_cm.replace(',', '.')) : 0,\n                                product_height_cm: record.product_height_cm ? parseFloat(record.product_height_cm.replace(',', '.')) : 0,\n                                product_width_cm: record.product_width_cm ? parseFloat(record.product_width_cm.replace(',', '.')) : 0,\n                                customer_city: record.customer_city || 'unknown',\n                                customer_state: record.customer_state || 'unknown',\n                                seller_id: record.seller_id || `missing_seller_id_${index + 1}`,\n                                seller_city: record.seller_city || 'unknown',\n                                seller_state: record.seller_state || 'unknown',\n                                payment_installments: record.payment_installments ? parseInt(record.payment_installments, 10) : 1\n                            };\n                        }));\n                    } catch (parseError) {\n                        console.error(`Error parsing file ${file1.name}:`, parseError);\n                        return res.status(500).json({\n                            error: `Error parsing file ${file1.name}: ${parseError.message}`\n                        });\n                    }\n                }\n            }\n        }\n        console.log('Data parsed successfully');\n        // Concatenate all orders from different years into a single array\n        const allOrders = Object.values(ordersByYear).flat();\n        // Remove duplicate products\n        const productSet = new Set();\n        const cleanProducts = products.filter((product)=>{\n            if (productSet.has(product.objectID)) {\n                return false; // Skip duplicate\n            } else {\n                productSet.add(product.objectID);\n                return true; // Keep unique\n            }\n        }).map((product)=>{\n            var ref, ref1, ref2, ref3;\n            return {\n                objectID: product.objectID || 'Unknown',\n                name: product.name || 'Unknown',\n                description: product.description || 'No description available',\n                brand: product.brand || 'Unknown brand',\n                categories: product.categories || [],\n                hierarchicalCategories: {\n                    lvl0: ((ref = product.hierarchicalCategories) === null || ref === void 0 ? void 0 : ref.lvl0) || 'Unknown',\n                    lvl1: ((ref1 = product.hierarchicalCategories) === null || ref1 === void 0 ? void 0 : ref1.lvl1) || 'Unknown',\n                    lvl2: ((ref2 = product.hierarchicalCategories) === null || ref2 === void 0 ? void 0 : ref2.lvl2) || 'Unknown',\n                    lvl3: ((ref3 = product.hierarchicalCategories) === null || ref3 === void 0 ? void 0 : ref3.lvl3) || 'Unknown'\n                },\n                type: product.type || 'Unknown type',\n                price: product.price || 0,\n                price_range: product.price_range || 'Unknown',\n                image: product.image || 'No image available',\n                url: product.url || 'No URL available',\n                free_shipping: product.free_shipping !== undefined ? product.free_shipping : false,\n                popularity: product.popularity || 0,\n                rating: product.rating || 0\n            };\n        });\n        // Remove duplicate orders\n        const orderSet = new Set();\n        const cleanOrders = allOrders.filter((order)=>{\n            if (orderSet.has(order.order_id)) {\n                return false; // Skip duplicate\n            } else {\n                orderSet.add(order.order_id);\n                return true; // Keep unique\n            }\n        }).map((order)=>({\n                ...order,\n                quantity: order.quantity || 1,\n                price_MRP: order.price_MRP || 0,\n                payment: order.payment || 0,\n                rating: order.rating || 0\n            })\n        );\n        console.log('Writing cleaned data to files');\n        fs__WEBPACK_IMPORTED_MODULE_2___default().writeFileSync(path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), 'public', 'products.json'), JSON.stringify(cleanProducts));\n        fs__WEBPACK_IMPORTED_MODULE_2___default().writeFileSync(path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), 'public', 'orders.json'), JSON.stringify(cleanOrders));\n        console.log('Files written successfully');\n        // Log a summary of orders grouped by year\n        for (const year of Object.keys(ordersByYear)){\n            console.log(`File orders/${year}/* downloaded`);\n        }\n        res.status(200).json({\n            message: 'ETL and data compilation process completed successfully'\n        });\n    } catch (error) {\n        console.error('Error during ETL and data compilation process:', error);\n        res.status(500).json({\n            error: error.message\n        });\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixDQUFDOztRQUVEbEQsT0FBTyxDQUFDQyxHQUFHLENBQUMsQ0FBK0I7UUFDM0NQLHVEQUFnQixDQUFDQyxnREFBUyxDQUFDVSxPQUFPLENBQUNLLEdBQUcsSUFBSSxDQUFRLFNBQUUsQ0FBZSxpQkFBR04sSUFBSSxDQUFDK0YsU0FBUyxDQUFDMUIsYUFBYTtRQUNsRy9FLHVEQUFnQixDQUFDQyxnREFBUyxDQUFDVSxPQUFPLENBQUNLLEdBQUcsSUFBSSxDQUFRLFNBQUUsQ0FBYSxlQUFHTixJQUFJLENBQUMrRixTQUFTLENBQUNILFdBQVc7UUFFOUZoRyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUE0QjtRQUV4QyxFQUEwQztRQUMxQyxHQUFHLEVBQUUsS0FBSyxDQUFDaUMsSUFBSSxJQUFJa0MsTUFBTSxDQUFDZ0MsSUFBSSxDQUFDaEYsWUFBWSxFQUFHLENBQUM7WUFDN0NwQixPQUFPLENBQUNDLEdBQUcsRUFBRSxZQUFZLEVBQUVpQyxJQUFJLENBQUMsYUFBYTtRQUMvQyxDQUFDO1FBRURuQyxHQUFHLENBQUNlLE1BQU0sQ0FBQyxHQUFHLEVBQUVDLElBQUksQ0FBQyxDQUFDO1lBQUNtRCxPQUFPLEVBQUUsQ0FBeUQ7UUFBQyxDQUFDO0lBQzdGLENBQUMsQ0FBQyxLQUFLLEVBQUVyRCxLQUFLLEVBQUUsQ0FBQztRQUNmYixPQUFPLENBQUNhLEtBQUssQ0FBQyxDQUFnRCxpREFBRUEsS0FBSztRQUNyRWQsR0FBRyxDQUFDZSxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztZQUFDRixLQUFLLEVBQUVBLEtBQUssQ0FBQ3FELE9BQU87UUFBQyxDQUFDO0lBQy9DLENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktZGFzaGJvYXJkLy4vcGFnZXMvYXBpL2V0bC5qcz9hMmNhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN0b3JhZ2UgfSBmcm9tICdAZ29vZ2xlLWNsb3VkL3N0b3JhZ2UnO1xyXG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ2Nzdi1wYXJzZS9zeW5jJztcclxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCBjb25maWcgZnJvbSAnLi4vLi4vY29uZmlnJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICBjb25zb2xlLmxvZygnU3RhcnRpbmcgRVRMIGFuZCBkYXRhIGNvbXBpbGF0aW9uIHByb2Nlc3MnKTtcclxuXHJcbiAgbGV0IHN0b3JhZ2U7XHJcbiAgXHJcbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcclxuICAgIC8vIEVuIGVudG9ybm8gZGUgcHJvZHVjY2nDs24sIGxlZXIgY3JlZGVuY2lhbGVzIGRlc2RlIGxhIHZhcmlhYmxlIGRlIGVudG9ybm9cclxuICAgIGNvbnN0IGNyZWRlbnRpYWxzID0gSlNPTi5wYXJzZShwcm9jZXNzLmVudi5HT09HTEVfQVBQTElDQVRJT05fQ1JFREVOVElBTFNfSlNPTik7XHJcbiAgICBzdG9yYWdlID0gbmV3IFN0b3JhZ2UoeyBjcmVkZW50aWFscyB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgLy8gRW4gZW50b3JubyBsb2NhbCwgbGVlciBjcmVkZW5jaWFsZXMgZGVzZGUgZWwgYXJjaGl2b1xyXG4gICAgY29uc3QgY3JlZGVudGlhbHNQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIGNvbmZpZy5HT09HTEVfQVBQTElDQVRJT05fQ1JFREVOVElBTFMpO1xyXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGNyZWRlbnRpYWxzUGF0aCkpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgQ3JlZGVudGlhbHMgZmlsZSBub3QgZm91bmQgYXQgJHtjcmVkZW50aWFsc1BhdGh9YCk7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBgQ3JlZGVudGlhbHMgZmlsZSBub3QgZm91bmQgYXQgJHtjcmVkZW50aWFsc1BhdGh9YCB9KTtcclxuICAgIH1cclxuICAgIHN0b3JhZ2UgPSBuZXcgU3RvcmFnZSh7IGtleUZpbGVuYW1lOiBjcmVkZW50aWFsc1BhdGggfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBidWNrZXQgPSBzdG9yYWdlLmJ1Y2tldChjb25maWcuQlVDS0VUX05BTUUpO1xyXG5cclxuICBjb25zdCBwcm9kdWN0cyA9IFtdO1xyXG4gIGNvbnN0IG9yZGVyc0J5WWVhciA9IHt9O1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ0F0dGVtcHRpbmcgdG8gcmV0cmlldmUgZmlsZXMgZnJvbSBidWNrZXQnKTtcclxuICAgIGNvbnN0IFtmaWxlc10gPSBhd2FpdCBidWNrZXQuZ2V0RmlsZXMoKTtcclxuICAgIGNvbnNvbGUubG9nKCdGaWxlcyByZXRyaWV2ZWQgZnJvbSBidWNrZXQ6JywgZmlsZXMubWFwKGZpbGUgPT4gZmlsZS5uYW1lKSk7XHJcbiAgICBjb25zb2xlLmxvZyhcIkRvd25sb2FkaW5nLi4uXCIpO1xyXG5cclxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgICBjb25zdCBbZGF0YV0gPSBhd2FpdCBmaWxlLmRvd25sb2FkKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZmlsZS5uYW1lLmluY2x1ZGVzKCdwcm9kdWN0cycpKSB7XHJcbiAgICAgICAgY29uc3QgcHJvZHVjdERhdGEgPSBKU09OLnBhcnNlKGRhdGEudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgcHJvZHVjdHMucHVzaCguLi5wcm9kdWN0RGF0YSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coYEZpbGUgJHtmaWxlLm5hbWV9IGRvd25sb2FkZWRgKTtcclxuICAgICAgfSBlbHNlIGlmIChmaWxlLm5hbWUuaW5jbHVkZXMoJ29yZGVycycpKSB7XHJcbiAgICAgICAgY29uc3QgeWVhck1hdGNoID0gZmlsZS5uYW1lLm1hdGNoKC9vcmRlcnNcXC8oXFxkezR9KVxcLy8pO1xyXG4gICAgICAgIGlmICh5ZWFyTWF0Y2gpIHtcclxuICAgICAgICAgIGNvbnN0IHllYXIgPSB5ZWFyTWF0Y2hbMV07XHJcbiAgICAgICAgICBpZiAoIW9yZGVyc0J5WWVhclt5ZWFyXSkge1xyXG4gICAgICAgICAgICBvcmRlcnNCeVllYXJbeWVhcl0gPSBbXTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZERhdGEgPSBwYXJzZShkYXRhLnRvU3RyaW5nKCksIHtcclxuICAgICAgICAgICAgICBjb2x1bW5zOiB0cnVlLFxyXG4gICAgICAgICAgICAgIHNraXBfZW1wdHlfbGluZXM6IHRydWUsXHJcbiAgICAgICAgICAgICAgZGVsaW1pdGVyOiAnOycsXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgb3JkZXJzQnlZZWFyW3llYXJdLnB1c2goLi4ucGFyc2VkRGF0YS5tYXAoKHJlY29yZCwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgb3JkZXJfaWQ6IHJlY29yZC5vcmRlcl9pZCB8fCBgbWlzc2luZ19vcmRlcl9pZF8ke2luZGV4ICsgMX1gLFxyXG4gICAgICAgICAgICAgICAgY3VzdG9tZXJfaWQ6IHJlY29yZC5jdXN0b21lcl9pZCB8fCBgbWlzc2luZ19jdXN0b21lcl9pZF8ke2luZGV4ICsgMX1gLFxyXG4gICAgICAgICAgICAgICAgcXVhbnRpdHk6IHJlY29yZC5xdWFudGl0eSA/IHBhcnNlSW50KHJlY29yZC5xdWFudGl0eS5yZXBsYWNlKCcsJywgJy4nKSwgMTApIDogMSxcclxuICAgICAgICAgICAgICAgIHByaWNlX01SUDogcmVjb3JkLnByaWNlX01SUCA/IHBhcnNlRmxvYXQocmVjb3JkLnByaWNlX01SUC5yZXBsYWNlKCcsJywgJy4nKSkgOiAwLFxyXG4gICAgICAgICAgICAgICAgcGF5bWVudDogcmVjb3JkLnBheW1lbnQgPyBwYXJzZUZsb2F0KHJlY29yZC5wYXltZW50LnJlcGxhY2UoJywnLCAnLicpKSA6IDAsXHJcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHJlY29yZC50aW1lc3RhbXAgfHwgJzE5NzAtMDEtMDEgMDA6MDA6MDAnLFxyXG4gICAgICAgICAgICAgICAgcmF0aW5nOiByZWNvcmQucmF0aW5nID8gcGFyc2VJbnQocmVjb3JkLnJhdGluZywgMTApIDogMCxcclxuICAgICAgICAgICAgICAgIHByb2R1Y3RfY2F0ZWdvcnk6IHJlY29yZC5wcm9kdWN0X2NhdGVnb3J5IHx8ICd1bmtub3duJyxcclxuICAgICAgICAgICAgICAgIHByb2R1Y3RfaWQ6IHJlY29yZC5wcm9kdWN0X2lkIHx8ICdOVUxMJyxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfdHlwZTogcmVjb3JkLnBheW1lbnRfdHlwZSB8fCAndW5rbm93bicsXHJcbiAgICAgICAgICAgICAgICBvcmRlcl9zdGF0dXM6IHJlY29yZC5vcmRlcl9zdGF0dXMgfHwgJ3Vua25vd24nLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdF93ZWlnaHRfZzogcmVjb3JkLnByb2R1Y3Rfd2VpZ2h0X2cgPyBwYXJzZUZsb2F0KHJlY29yZC5wcm9kdWN0X3dlaWdodF9nLnJlcGxhY2UoJywnLCAnLicpKSA6IDAsXHJcbiAgICAgICAgICAgICAgICBwcm9kdWN0X2xlbmd0aF9jbTogcmVjb3JkLnByb2R1Y3RfbGVuZ3RoX2NtID8gcGFyc2VGbG9hdChyZWNvcmQucHJvZHVjdF9sZW5ndGhfY20ucmVwbGFjZSgnLCcsICcuJykpIDogMCxcclxuICAgICAgICAgICAgICAgIHByb2R1Y3RfaGVpZ2h0X2NtOiByZWNvcmQucHJvZHVjdF9oZWlnaHRfY20gPyBwYXJzZUZsb2F0KHJlY29yZC5wcm9kdWN0X2hlaWdodF9jbS5yZXBsYWNlKCcsJywgJy4nKSkgOiAwLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdF93aWR0aF9jbTogcmVjb3JkLnByb2R1Y3Rfd2lkdGhfY20gPyBwYXJzZUZsb2F0KHJlY29yZC5wcm9kdWN0X3dpZHRoX2NtLnJlcGxhY2UoJywnLCAnLicpKSA6IDAsXHJcbiAgICAgICAgICAgICAgICBjdXN0b21lcl9jaXR5OiByZWNvcmQuY3VzdG9tZXJfY2l0eSB8fCAndW5rbm93bicsXHJcbiAgICAgICAgICAgICAgICBjdXN0b21lcl9zdGF0ZTogcmVjb3JkLmN1c3RvbWVyX3N0YXRlIHx8ICd1bmtub3duJyxcclxuICAgICAgICAgICAgICAgIHNlbGxlcl9pZDogcmVjb3JkLnNlbGxlcl9pZCB8fCBgbWlzc2luZ19zZWxsZXJfaWRfJHtpbmRleCArIDF9YCxcclxuICAgICAgICAgICAgICAgIHNlbGxlcl9jaXR5OiByZWNvcmQuc2VsbGVyX2NpdHkgfHwgJ3Vua25vd24nLFxyXG4gICAgICAgICAgICAgICAgc2VsbGVyX3N0YXRlOiByZWNvcmQuc2VsbGVyX3N0YXRlIHx8ICd1bmtub3duJyxcclxuICAgICAgICAgICAgICAgIHBheW1lbnRfaW5zdGFsbG1lbnRzOiByZWNvcmQucGF5bWVudF9pbnN0YWxsbWVudHMgPyBwYXJzZUludChyZWNvcmQucGF5bWVudF9pbnN0YWxsbWVudHMsIDEwKSA6IDEsXHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBwYXJzaW5nIGZpbGUgJHtmaWxlLm5hbWV9OmAsIHBhcnNlRXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogYEVycm9yIHBhcnNpbmcgZmlsZSAke2ZpbGUubmFtZX06ICR7cGFyc2VFcnJvci5tZXNzYWdlfWAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0RhdGEgcGFyc2VkIHN1Y2Nlc3NmdWxseScpO1xyXG5cclxuICAgIC8vIENvbmNhdGVuYXRlIGFsbCBvcmRlcnMgZnJvbSBkaWZmZXJlbnQgeWVhcnMgaW50byBhIHNpbmdsZSBhcnJheVxyXG4gICAgY29uc3QgYWxsT3JkZXJzID0gT2JqZWN0LnZhbHVlcyhvcmRlcnNCeVllYXIpLmZsYXQoKTtcclxuXHJcbiAgICAvLyBSZW1vdmUgZHVwbGljYXRlIHByb2R1Y3RzXHJcbiAgICBjb25zdCBwcm9kdWN0U2V0ID0gbmV3IFNldCgpO1xyXG4gICAgY29uc3QgY2xlYW5Qcm9kdWN0cyA9IHByb2R1Y3RzLmZpbHRlcihwcm9kdWN0ID0+IHtcclxuICAgICAgaWYgKHByb2R1Y3RTZXQuaGFzKHByb2R1Y3Qub2JqZWN0SUQpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBTa2lwIGR1cGxpY2F0ZVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHByb2R1Y3RTZXQuYWRkKHByb2R1Y3Qub2JqZWN0SUQpO1xyXG4gICAgICAgIHJldHVybiB0cnVlOyAvLyBLZWVwIHVuaXF1ZVxyXG4gICAgICB9XHJcbiAgICB9KS5tYXAocHJvZHVjdCA9PiAoe1xyXG4gICAgICBvYmplY3RJRDogcHJvZHVjdC5vYmplY3RJRCB8fCAnVW5rbm93bicsXHJcbiAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSB8fCAnVW5rbm93bicsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBwcm9kdWN0LmRlc2NyaXB0aW9uIHx8ICdObyBkZXNjcmlwdGlvbiBhdmFpbGFibGUnLFxyXG4gICAgICBicmFuZDogcHJvZHVjdC5icmFuZCB8fCAnVW5rbm93biBicmFuZCcsXHJcbiAgICAgIGNhdGVnb3JpZXM6IHByb2R1Y3QuY2F0ZWdvcmllcyB8fCBbXSxcclxuICAgICAgaGllcmFyY2hpY2FsQ2F0ZWdvcmllczoge1xyXG4gICAgICAgIGx2bDA6IHByb2R1Y3QuaGllcmFyY2hpY2FsQ2F0ZWdvcmllcz8ubHZsMCB8fCAnVW5rbm93bicsXHJcbiAgICAgICAgbHZsMTogcHJvZHVjdC5oaWVyYXJjaGljYWxDYXRlZ29yaWVzPy5sdmwxIHx8ICdVbmtub3duJyxcclxuICAgICAgICBsdmwyOiBwcm9kdWN0LmhpZXJhcmNoaWNhbENhdGVnb3JpZXM/Lmx2bDIgfHwgJ1Vua25vd24nLFxyXG4gICAgICAgIGx2bDM6IHByb2R1Y3QuaGllcmFyY2hpY2FsQ2F0ZWdvcmllcz8ubHZsMyB8fCAnVW5rbm93bicsXHJcbiAgICAgIH0sXHJcbiAgICAgIHR5cGU6IHByb2R1Y3QudHlwZSB8fCAnVW5rbm93biB0eXBlJyxcclxuICAgICAgcHJpY2U6IHByb2R1Y3QucHJpY2UgfHwgMCxcclxuICAgICAgcHJpY2VfcmFuZ2U6IHByb2R1Y3QucHJpY2VfcmFuZ2UgfHwgJ1Vua25vd24nLFxyXG4gICAgICBpbWFnZTogcHJvZHVjdC5pbWFnZSB8fCAnTm8gaW1hZ2UgYXZhaWxhYmxlJyxcclxuICAgICAgdXJsOiBwcm9kdWN0LnVybCB8fCAnTm8gVVJMIGF2YWlsYWJsZScsXHJcbiAgICAgIGZyZWVfc2hpcHBpbmc6IHByb2R1Y3QuZnJlZV9zaGlwcGluZyAhPT0gdW5kZWZpbmVkID8gcHJvZHVjdC5mcmVlX3NoaXBwaW5nIDogZmFsc2UsXHJcbiAgICAgIHBvcHVsYXJpdHk6IHByb2R1Y3QucG9wdWxhcml0eSB8fCAwLFxyXG4gICAgICByYXRpbmc6IHByb2R1Y3QucmF0aW5nIHx8IDAsXHJcbiAgICB9KSk7XHJcblxyXG4gICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZSBvcmRlcnNcclxuICAgIGNvbnN0IG9yZGVyU2V0ID0gbmV3IFNldCgpO1xyXG4gICAgY29uc3QgY2xlYW5PcmRlcnMgPSBhbGxPcmRlcnMuZmlsdGVyKG9yZGVyID0+IHtcclxuICAgICAgaWYgKG9yZGVyU2V0LmhhcyhvcmRlci5vcmRlcl9pZCkpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7IC8vIFNraXAgZHVwbGljYXRlXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgb3JkZXJTZXQuYWRkKG9yZGVyLm9yZGVyX2lkKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gS2VlcCB1bmlxdWVcclxuICAgICAgfVxyXG4gICAgfSkubWFwKG9yZGVyID0+ICh7XHJcbiAgICAgIC4uLm9yZGVyLFxyXG4gICAgICBxdWFudGl0eTogb3JkZXIucXVhbnRpdHkgfHwgMSxcclxuICAgICAgcHJpY2VfTVJQOiBvcmRlci5wcmljZV9NUlAgfHwgMCxcclxuICAgICAgcGF5bWVudDogb3JkZXIucGF5bWVudCB8fCAwLFxyXG4gICAgICByYXRpbmc6IG9yZGVyLnJhdGluZyB8fCAwLFxyXG4gICAgfSkpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdXcml0aW5nIGNsZWFuZWQgZGF0YSB0byBmaWxlcycpO1xyXG4gICAgZnMud3JpdGVGaWxlU3luYyhwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B1YmxpYycsICdwcm9kdWN0cy5qc29uJyksIEpTT04uc3RyaW5naWZ5KGNsZWFuUHJvZHVjdHMpKTtcclxuICAgIGZzLndyaXRlRmlsZVN5bmMocGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdwdWJsaWMnLCAnb3JkZXJzLmpzb24nKSwgSlNPTi5zdHJpbmdpZnkoY2xlYW5PcmRlcnMpKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnRmlsZXMgd3JpdHRlbiBzdWNjZXNzZnVsbHknKTtcclxuXHJcbiAgICAvLyBMb2cgYSBzdW1tYXJ5IG9mIG9yZGVycyBncm91cGVkIGJ5IHllYXJcclxuICAgIGZvciAoY29uc3QgeWVhciBvZiBPYmplY3Qua2V5cyhvcmRlcnNCeVllYXIpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBGaWxlIG9yZGVycy8ke3llYXJ9LyogZG93bmxvYWRlZGApO1xyXG4gICAgfVxyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ0VUTCBhbmQgZGF0YSBjb21waWxhdGlvbiBwcm9jZXNzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgRVRMIGFuZCBkYXRhIGNvbXBpbGF0aW9uIHByb2Nlc3M6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIlN0b3JhZ2UiLCJwYXJzZSIsImZzIiwicGF0aCIsImNvbmZpZyIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJjb25zb2xlIiwibG9nIiwic3RvcmFnZSIsImNyZWRlbnRpYWxzIiwiSlNPTiIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQVBQTElDQVRJT05fQ1JFREVOVElBTFNfSlNPTiIsImNyZWRlbnRpYWxzUGF0aCIsImpvaW4iLCJjd2QiLCJHT09HTEVfQVBQTElDQVRJT05fQ1JFREVOVElBTFMiLCJleGlzdHNTeW5jIiwiZXJyb3IiLCJzdGF0dXMiLCJqc29uIiwia2V5RmlsZW5hbWUiLCJidWNrZXQiLCJCVUNLRVRfTkFNRSIsInByb2R1Y3RzIiwib3JkZXJzQnlZZWFyIiwiZmlsZXMiLCJnZXRGaWxlcyIsIm1hcCIsImZpbGUiLCJuYW1lIiwiZGF0YSIsImRvd25sb2FkIiwiaW5jbHVkZXMiLCJwcm9kdWN0RGF0YSIsInRvU3RyaW5nIiwicHVzaCIsInllYXJNYXRjaCIsIm1hdGNoIiwieWVhciIsInBhcnNlZERhdGEiLCJjb2x1bW5zIiwic2tpcF9lbXB0eV9saW5lcyIsImRlbGltaXRlciIsInJlY29yZCIsImluZGV4Iiwib3JkZXJfaWQiLCJjdXN0b21lcl9pZCIsInF1YW50aXR5IiwicGFyc2VJbnQiLCJyZXBsYWNlIiwicHJpY2VfTVJQIiwicGFyc2VGbG9hdCIsInBheW1lbnQiLCJ0aW1lc3RhbXAiLCJyYXRpbmciLCJwcm9kdWN0X2NhdGVnb3J5IiwicHJvZHVjdF9pZCIsInBheW1lbnRfdHlwZSIsIm9yZGVyX3N0YXR1cyIsInByb2R1Y3Rfd2VpZ2h0X2ciLCJwcm9kdWN0X2xlbmd0aF9jbSIsInByb2R1Y3RfaGVpZ2h0X2NtIiwicHJvZHVjdF93aWR0aF9jbSIsImN1c3RvbWVyX2NpdHkiLCJjdXN0b21lcl9zdGF0ZSIsInNlbGxlcl9pZCIsInNlbGxlcl9jaXR5Iiwic2VsbGVyX3N0YXRlIiwicGF5bWVudF9pbnN0YWxsbWVudHMiLCJwYXJzZUVycm9yIiwibWVzc2FnZSIsImFsbE9yZGVycyIsIk9iamVjdCIsInZhbHVlcyIsImZsYXQiLCJwcm9kdWN0U2V0IiwiU2V0IiwiY2xlYW5Qcm9kdWN0cyIsImZpbHRlciIsInByb2R1Y3QiLCJoYXMiLCJvYmplY3RJRCIsImFkZCIsImRlc2NyaXB0aW9uIiwiYnJhbmQiLCJjYXRlZ29yaWVzIiwiaGllcmFyY2hpY2FsQ2F0ZWdvcmllcyIsImx2bDAiLCJsdmwxIiwibHZsMiIsImx2bDMiLCJ0eXBlIiwicHJpY2UiLCJwcmljZV9yYW5nZSIsImltYWdlIiwidXJsIiwiZnJlZV9zaGlwcGluZyIsInVuZGVmaW5lZCIsInBvcHVsYXJpdHkiLCJvcmRlclNldCIsImNsZWFuT3JkZXJzIiwib3JkZXIiLCJ3cml0ZUZpbGVTeW5jIiwic3RyaW5naWZ5Iiwia2V5cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/etl.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/etl.js"));
module.exports = __webpack_exports__;

})();