"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/etl";
exports.ids = ["pages/api/etl"];
exports.modules = {

/***/ "@google-cloud/storage":
/*!****************************************!*\
  !*** external "@google-cloud/storage" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@google-cloud/storage");

/***/ }),

/***/ "csv-parse/sync":
/*!*********************************!*\
  !*** external "csv-parse/sync" ***!
  \*********************************/
/***/ ((module) => {

module.exports = import("csv-parse/sync");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./config.js":
/*!*******************!*\
  !*** ./config.js ***!
  \*******************/
/***/ ((module) => {

eval("\nmodule.exports = {\n    BUCKET_NAME: '2024-1-tarea-3',\n    GOOGLE_APPLICATION_CREDENTIALS: './taller-integracion-310700-41f361102b8b.json'\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9jb25maWcuanMuanMiLCJtYXBwaW5ncyI6IjtBQUFBQSxNQUFNLENBQUNDLE9BQU8sR0FBRyxDQUFDO0lBQ2RDLFdBQVcsRUFBRSxDQUFnQjtJQUM3QkMsOEJBQThCLEVBQUUsQ0FBK0M7QUFDakYsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL215LWRhc2hib2FyZC8uL2NvbmZpZy5qcz9jMmIzIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgQlVDS0VUX05BTUU6ICcyMDI0LTEtdGFyZWEtMycsXHJcbiAgICBHT09HTEVfQVBQTElDQVRJT05fQ1JFREVOVElBTFM6ICcuL3RhbGxlci1pbnRlZ3JhY2lvbi0zMTA3MDAtNDFmMzYxMTAyYjhiLmpzb24nLFxyXG4gIH07XHJcbiAgIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJCVUNLRVRfTkFNRSIsIkdPT0dMRV9BUFBMSUNBVElPTl9DUkVERU5USUFMUyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./config.js\n");

/***/ }),

/***/ "(api)/./pages/api/etl.js":
/*!**************************!*\
  !*** ./pages/api/etl.js ***!
  \**************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _google_cloud_storage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google-cloud/storage */ \"@google-cloud/storage\");\n/* harmony import */ var _google_cloud_storage__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_google_cloud_storage__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var csv_parse_sync__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! csv-parse/sync */ \"csv-parse/sync\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../config */ \"(api)/./config.js\");\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_config__WEBPACK_IMPORTED_MODULE_4__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([csv_parse_sync__WEBPACK_IMPORTED_MODULE_1__]);\ncsv_parse_sync__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\nasync function handler(req, res) {\n    console.log('Starting ETL and data compilation process');\n    // Verificar si el archivo de credenciales existe\n    const credentialsPath = path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), (_config__WEBPACK_IMPORTED_MODULE_4___default().GOOGLE_APPLICATION_CREDENTIALS));\n    if (!fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(credentialsPath)) {\n        console.error(`Credentials file not found at ${credentialsPath}`);\n        return res.status(500).json({\n            error: `Credentials file not found at ${credentialsPath}`\n        });\n    }\n    const storage = new _google_cloud_storage__WEBPACK_IMPORTED_MODULE_0__.Storage({\n        keyFilename: credentialsPath\n    });\n    const bucket = storage.bucket((_config__WEBPACK_IMPORTED_MODULE_4___default().BUCKET_NAME));\n    const products = [];\n    const ordersByYear = {};\n    try {\n        console.log('Attempting to retrieve files from bucket');\n        const [files] = await bucket.getFiles();\n        console.log('Files retrieved from bucket:', files.map((file)=>file.name\n        ));\n        console.log(\"Downloading...\");\n        for (const file1 of files){\n            const [data] = await file1.download();\n            if (file1.name.includes('products')) {\n                const productData = JSON.parse(data.toString());\n                products.push(...productData);\n                console.log(`File ${file1.name} downloaded`);\n            } else if (file1.name.includes('orders')) {\n                const yearMatch = file1.name.match(/orders\\/(\\d{4})\\//);\n                if (yearMatch) {\n                    const year = yearMatch[1];\n                    if (!ordersByYear[year]) {\n                        ordersByYear[year] = [];\n                    }\n                    try {\n                        const parsedData = (0,csv_parse_sync__WEBPACK_IMPORTED_MODULE_1__.parse)(data.toString(), {\n                            columns: true,\n                            skip_empty_lines: true,\n                            delimiter: ';'\n                        });\n                        ordersByYear[year].push(...parsedData.map((record, index)=>{\n                            return {\n                                order_id: record.order_id || `missing_order_id_${index + 1}`,\n                                customer_id: record.customer_id || `missing_customer_id_${index + 1}`,\n                                quantity: record.quantity ? parseInt(record.quantity.replace(',', '.'), 10) : 1,\n                                price_MRP: record.price_MRP ? parseFloat(record.price_MRP.replace(',', '.')) : 0,\n                                payment: record.payment ? parseFloat(record.payment.replace(',', '.')) : 0,\n                                timestamp: record.timestamp || '1970-01-01 00:00:00',\n                                rating: record.rating ? parseInt(record.rating, 10) : 0,\n                                product_category: record.product_category || 'unknown',\n                                product_id: record.product_id || 'NULL',\n                                payment_type: record.payment_type || 'unknown',\n                                order_status: record.order_status || 'unknown',\n                                product_weight_g: record.product_weight_g ? parseFloat(record.product_weight_g.replace(',', '.')) : 0,\n                                product_length_cm: record.product_length_cm ? parseFloat(record.product_length_cm.replace(',', '.')) : 0,\n                                product_height_cm: record.product_height_cm ? parseFloat(record.product_height_cm.replace(',', '.')) : 0,\n                                product_width_cm: record.product_width_cm ? parseFloat(record.product_width_cm.replace(',', '.')) : 0,\n                                customer_city: record.customer_city || 'unknown',\n                                customer_state: record.customer_state || 'unknown',\n                                seller_id: record.seller_id || `missing_seller_id_${index + 1}`,\n                                seller_city: record.seller_city || 'unknown',\n                                seller_state: record.seller_state || 'unknown',\n                                payment_installments: record.payment_installments ? parseInt(record.payment_installments, 10) : 1\n                            };\n                        }));\n                    } catch (parseError) {\n                        console.error(`Error parsing file ${file1.name}:`, parseError);\n                        return res.status(500).json({\n                            error: `Error parsing file ${file1.name}: ${parseError.message}`\n                        });\n                    }\n                }\n            }\n        }\n        console.log('Data parsed successfully');\n        // Concatenate all orders from different years into a single array\n        const allOrders = Object.values(ordersByYear).flat();\n        // Remove duplicate products\n        const productSet = new Set();\n        const cleanProducts = products.filter((product)=>{\n            if (productSet.has(product.objectID)) {\n                return false; // Skip duplicate\n            } else {\n                productSet.add(product.objectID);\n                return true; // Keep unique\n            }\n        }).map((product)=>{\n            var ref, ref1, ref2, ref3;\n            return {\n                objectID: product.objectID || 'Unknown',\n                name: product.name || 'Unknown',\n                description: product.description || 'No description available',\n                brand: product.brand || 'Unknown brand',\n                categories: product.categories || [],\n                hierarchicalCategories: {\n                    lvl0: ((ref = product.hierarchicalCategories) === null || ref === void 0 ? void 0 : ref.lvl0) || 'Unknown',\n                    lvl1: ((ref1 = product.hierarchicalCategories) === null || ref1 === void 0 ? void 0 : ref1.lvl1) || 'Unknown',\n                    lvl2: ((ref2 = product.hierarchicalCategories) === null || ref2 === void 0 ? void 0 : ref2.lvl2) || 'Unknown',\n                    lvl3: ((ref3 = product.hierarchicalCategories) === null || ref3 === void 0 ? void 0 : ref3.lvl3) || 'Unknown'\n                },\n                type: product.type || 'Unknown type',\n                price: product.price || 0,\n                price_range: product.price_range || 'Unknown',\n                image: product.image || 'No image available',\n                url: product.url || 'No URL available',\n                free_shipping: product.free_shipping !== undefined ? product.free_shipping : false,\n                popularity: product.popularity || 0,\n                rating: product.rating || 0\n            };\n        });\n        // Remove duplicate orders\n        const orderSet = new Set();\n        const cleanOrders = allOrders.filter((order)=>{\n            if (orderSet.has(order.order_id)) {\n                return false; // Skip duplicate\n            } else {\n                orderSet.add(order.order_id);\n                return true; // Keep unique\n            }\n        }).map((order)=>({\n                ...order,\n                quantity: order.quantity || 1,\n                price_MRP: order.price_MRP || 0,\n                payment: order.payment || 0,\n                rating: order.rating || 0\n            })\n        );\n        console.log('Writing cleaned data to files');\n        fs__WEBPACK_IMPORTED_MODULE_2___default().writeFileSync(path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), 'public', 'products.json'), JSON.stringify(cleanProducts));\n        fs__WEBPACK_IMPORTED_MODULE_2___default().writeFileSync(path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), 'public', 'orders.json'), JSON.stringify(cleanOrders));\n        console.log('Files written successfully');\n        // Log a summary of orders grouped by year\n        for (const year of Object.keys(ordersByYear)){\n            console.log(`File orders/${year}/* downloaded`);\n        }\n        res.status(200).json({\n            message: 'ETL and data compilation process completed successfully'\n        });\n    } catch (error) {\n        console.error('Error during ETL and data compilation process:', error);\n        res.status(500).json({\n            error: error.message\n        });\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0RBQVMsQ0FBQ1MsT0FBTyxDQUFDQyxHQUFHLElBQUksQ0FBUSxTQUFFLENBQWUsaUJBQUdxQixJQUFJLENBQUNzRSxTQUFTLENBQUMxQixhQUFhO1FBQ2xHNUUsdURBQWdCLENBQUNDLGdEQUFTLENBQUNTLE9BQU8sQ0FBQ0MsR0FBRyxJQUFJLENBQVEsU0FBRSxDQUFhLGVBQUdxQixJQUFJLENBQUNzRSxTQUFTLENBQUNILFdBQVc7UUFFOUY3RixPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUE0QjtRQUV4QyxFQUEwQztRQUMxQyxHQUFHLEVBQUUsS0FBSyxDQUFDOEIsSUFBSSxJQUFJa0MsTUFBTSxDQUFDZ0MsSUFBSSxDQUFDakYsWUFBWSxFQUFHLENBQUM7WUFDN0NoQixPQUFPLENBQUNDLEdBQUcsRUFBRSxZQUFZLEVBQUU4QixJQUFJLENBQUMsYUFBYTtRQUMvQyxDQUFDO1FBRURoQyxHQUFHLENBQUNVLE1BQU0sQ0FBQyxHQUFHLEVBQUVDLElBQUksQ0FBQyxDQUFDO1lBQUNxRCxPQUFPLEVBQUUsQ0FBeUQ7UUFBQyxDQUFDO0lBQzdGLENBQUMsQ0FBQyxLQUFLLEVBQUV2RCxLQUFLLEVBQUUsQ0FBQztRQUNmUixPQUFPLENBQUNRLEtBQUssQ0FBQyxDQUFnRCxpREFBRUEsS0FBSztRQUNyRVQsR0FBRyxDQUFDVSxNQUFNLENBQUMsR0FBRyxFQUFFQyxJQUFJLENBQUMsQ0FBQztZQUFDRixLQUFLLEVBQUVBLEtBQUssQ0FBQ3VELE9BQU87UUFBQyxDQUFDO0lBQy9DLENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktZGFzaGJvYXJkLy4vcGFnZXMvYXBpL2V0bC5qcz9hMmNhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN0b3JhZ2UgfSBmcm9tICdAZ29vZ2xlLWNsb3VkL3N0b3JhZ2UnO1xyXG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ2Nzdi1wYXJzZS9zeW5jJztcclxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCBjb25maWcgZnJvbSAnLi4vLi4vY29uZmlnJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICBjb25zb2xlLmxvZygnU3RhcnRpbmcgRVRMIGFuZCBkYXRhIGNvbXBpbGF0aW9uIHByb2Nlc3MnKTtcclxuXHJcbiAgLy8gVmVyaWZpY2FyIHNpIGVsIGFyY2hpdm8gZGUgY3JlZGVuY2lhbGVzIGV4aXN0ZVxyXG4gIGNvbnN0IGNyZWRlbnRpYWxzUGF0aCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBjb25maWcuR09PR0xFX0FQUExJQ0FUSU9OX0NSRURFTlRJQUxTKTtcclxuICBpZiAoIWZzLmV4aXN0c1N5bmMoY3JlZGVudGlhbHNQYXRoKSkge1xyXG4gICAgY29uc29sZS5lcnJvcihgQ3JlZGVudGlhbHMgZmlsZSBub3QgZm91bmQgYXQgJHtjcmVkZW50aWFsc1BhdGh9YCk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogYENyZWRlbnRpYWxzIGZpbGUgbm90IGZvdW5kIGF0ICR7Y3JlZGVudGlhbHNQYXRofWAgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBzdG9yYWdlID0gbmV3IFN0b3JhZ2Uoe1xyXG4gICAga2V5RmlsZW5hbWU6IGNyZWRlbnRpYWxzUGF0aCxcclxuICB9KTtcclxuXHJcbiAgY29uc3QgYnVja2V0ID0gc3RvcmFnZS5idWNrZXQoY29uZmlnLkJVQ0tFVF9OQU1FKTtcclxuXHJcbiAgY29uc3QgcHJvZHVjdHMgPSBbXTtcclxuICBjb25zdCBvcmRlcnNCeVllYXIgPSB7fTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIHRvIHJldHJpZXZlIGZpbGVzIGZyb20gYnVja2V0Jyk7XHJcbiAgICBjb25zdCBbZmlsZXNdID0gYXdhaXQgYnVja2V0LmdldEZpbGVzKCk7XHJcbiAgICBjb25zb2xlLmxvZygnRmlsZXMgcmV0cmlldmVkIGZyb20gYnVja2V0OicsIGZpbGVzLm1hcChmaWxlID0+IGZpbGUubmFtZSkpO1xyXG4gICAgY29uc29sZS5sb2coXCJEb3dubG9hZGluZy4uLlwiKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcclxuICAgICAgY29uc3QgW2RhdGFdID0gYXdhaXQgZmlsZS5kb3dubG9hZCgpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGZpbGUubmFtZS5pbmNsdWRlcygncHJvZHVjdHMnKSkge1xyXG4gICAgICAgIGNvbnN0IHByb2R1Y3REYXRhID0gSlNPTi5wYXJzZShkYXRhLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIHByb2R1Y3RzLnB1c2goLi4ucHJvZHVjdERhdGEpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBGaWxlICR7ZmlsZS5uYW1lfSBkb3dubG9hZGVkYCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoZmlsZS5uYW1lLmluY2x1ZGVzKCdvcmRlcnMnKSkge1xyXG4gICAgICAgIGNvbnN0IHllYXJNYXRjaCA9IGZpbGUubmFtZS5tYXRjaCgvb3JkZXJzXFwvKFxcZHs0fSlcXC8vKTtcclxuICAgICAgICBpZiAoeWVhck1hdGNoKSB7XHJcbiAgICAgICAgICBjb25zdCB5ZWFyID0geWVhck1hdGNoWzFdO1xyXG4gICAgICAgICAgaWYgKCFvcmRlcnNCeVllYXJbeWVhcl0pIHtcclxuICAgICAgICAgICAgb3JkZXJzQnlZZWFyW3llYXJdID0gW107XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJzZWREYXRhID0gcGFyc2UoZGF0YS50b1N0cmluZygpLCB7XHJcbiAgICAgICAgICAgICAgY29sdW1uczogdHJ1ZSxcclxuICAgICAgICAgICAgICBza2lwX2VtcHR5X2xpbmVzOiB0cnVlLFxyXG4gICAgICAgICAgICAgIGRlbGltaXRlcjogJzsnLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIG9yZGVyc0J5WWVhclt5ZWFyXS5wdXNoKC4uLnBhcnNlZERhdGEubWFwKChyZWNvcmQsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIG9yZGVyX2lkOiByZWNvcmQub3JkZXJfaWQgfHwgYG1pc3Npbmdfb3JkZXJfaWRfJHtpbmRleCArIDF9YCxcclxuICAgICAgICAgICAgICAgIGN1c3RvbWVyX2lkOiByZWNvcmQuY3VzdG9tZXJfaWQgfHwgYG1pc3NpbmdfY3VzdG9tZXJfaWRfJHtpbmRleCArIDF9YCxcclxuICAgICAgICAgICAgICAgIHF1YW50aXR5OiByZWNvcmQucXVhbnRpdHkgPyBwYXJzZUludChyZWNvcmQucXVhbnRpdHkucmVwbGFjZSgnLCcsICcuJyksIDEwKSA6IDEsXHJcbiAgICAgICAgICAgICAgICBwcmljZV9NUlA6IHJlY29yZC5wcmljZV9NUlAgPyBwYXJzZUZsb2F0KHJlY29yZC5wcmljZV9NUlAucmVwbGFjZSgnLCcsICcuJykpIDogMCxcclxuICAgICAgICAgICAgICAgIHBheW1lbnQ6IHJlY29yZC5wYXltZW50ID8gcGFyc2VGbG9hdChyZWNvcmQucGF5bWVudC5yZXBsYWNlKCcsJywgJy4nKSkgOiAwLFxyXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wOiByZWNvcmQudGltZXN0YW1wIHx8ICcxOTcwLTAxLTAxIDAwOjAwOjAwJyxcclxuICAgICAgICAgICAgICAgIHJhdGluZzogcmVjb3JkLnJhdGluZyA/IHBhcnNlSW50KHJlY29yZC5yYXRpbmcsIDEwKSA6IDAsXHJcbiAgICAgICAgICAgICAgICBwcm9kdWN0X2NhdGVnb3J5OiByZWNvcmQucHJvZHVjdF9jYXRlZ29yeSB8fCAndW5rbm93bicsXHJcbiAgICAgICAgICAgICAgICBwcm9kdWN0X2lkOiByZWNvcmQucHJvZHVjdF9pZCB8fCAnTlVMTCcsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50X3R5cGU6IHJlY29yZC5wYXltZW50X3R5cGUgfHwgJ3Vua25vd24nLFxyXG4gICAgICAgICAgICAgICAgb3JkZXJfc3RhdHVzOiByZWNvcmQub3JkZXJfc3RhdHVzIHx8ICd1bmtub3duJyxcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Rfd2VpZ2h0X2c6IHJlY29yZC5wcm9kdWN0X3dlaWdodF9nID8gcGFyc2VGbG9hdChyZWNvcmQucHJvZHVjdF93ZWlnaHRfZy5yZXBsYWNlKCcsJywgJy4nKSkgOiAwLFxyXG4gICAgICAgICAgICAgICAgcHJvZHVjdF9sZW5ndGhfY206IHJlY29yZC5wcm9kdWN0X2xlbmd0aF9jbSA/IHBhcnNlRmxvYXQocmVjb3JkLnByb2R1Y3RfbGVuZ3RoX2NtLnJlcGxhY2UoJywnLCAnLicpKSA6IDAsXHJcbiAgICAgICAgICAgICAgICBwcm9kdWN0X2hlaWdodF9jbTogcmVjb3JkLnByb2R1Y3RfaGVpZ2h0X2NtID8gcGFyc2VGbG9hdChyZWNvcmQucHJvZHVjdF9oZWlnaHRfY20ucmVwbGFjZSgnLCcsICcuJykpIDogMCxcclxuICAgICAgICAgICAgICAgIHByb2R1Y3Rfd2lkdGhfY206IHJlY29yZC5wcm9kdWN0X3dpZHRoX2NtID8gcGFyc2VGbG9hdChyZWNvcmQucHJvZHVjdF93aWR0aF9jbS5yZXBsYWNlKCcsJywgJy4nKSkgOiAwLFxyXG4gICAgICAgICAgICAgICAgY3VzdG9tZXJfY2l0eTogcmVjb3JkLmN1c3RvbWVyX2NpdHkgfHwgJ3Vua25vd24nLFxyXG4gICAgICAgICAgICAgICAgY3VzdG9tZXJfc3RhdGU6IHJlY29yZC5jdXN0b21lcl9zdGF0ZSB8fCAndW5rbm93bicsXHJcbiAgICAgICAgICAgICAgICBzZWxsZXJfaWQ6IHJlY29yZC5zZWxsZXJfaWQgfHwgYG1pc3Npbmdfc2VsbGVyX2lkXyR7aW5kZXggKyAxfWAsXHJcbiAgICAgICAgICAgICAgICBzZWxsZXJfY2l0eTogcmVjb3JkLnNlbGxlcl9jaXR5IHx8ICd1bmtub3duJyxcclxuICAgICAgICAgICAgICAgIHNlbGxlcl9zdGF0ZTogcmVjb3JkLnNlbGxlcl9zdGF0ZSB8fCAndW5rbm93bicsXHJcbiAgICAgICAgICAgICAgICBwYXltZW50X2luc3RhbGxtZW50czogcmVjb3JkLnBheW1lbnRfaW5zdGFsbG1lbnRzID8gcGFyc2VJbnQocmVjb3JkLnBheW1lbnRfaW5zdGFsbG1lbnRzLCAxMCkgOiAxLFxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcGFyc2luZyBmaWxlICR7ZmlsZS5uYW1lfTpgLCBwYXJzZUVycm9yKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGBFcnJvciBwYXJzaW5nIGZpbGUgJHtmaWxlLm5hbWV9OiAke3BhcnNlRXJyb3IubWVzc2FnZX1gIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKCdEYXRhIHBhcnNlZCBzdWNjZXNzZnVsbHknKTtcclxuXHJcbiAgICAvLyBDb25jYXRlbmF0ZSBhbGwgb3JkZXJzIGZyb20gZGlmZmVyZW50IHllYXJzIGludG8gYSBzaW5nbGUgYXJyYXlcclxuICAgIGNvbnN0IGFsbE9yZGVycyA9IE9iamVjdC52YWx1ZXMob3JkZXJzQnlZZWFyKS5mbGF0KCk7XHJcblxyXG4gICAgLy8gUmVtb3ZlIGR1cGxpY2F0ZSBwcm9kdWN0c1xyXG4gICAgY29uc3QgcHJvZHVjdFNldCA9IG5ldyBTZXQoKTtcclxuICAgIGNvbnN0IGNsZWFuUHJvZHVjdHMgPSBwcm9kdWN0cy5maWx0ZXIocHJvZHVjdCA9PiB7XHJcbiAgICAgIGlmIChwcm9kdWN0U2V0Lmhhcyhwcm9kdWN0Lm9iamVjdElEKSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTsgLy8gU2tpcCBkdXBsaWNhdGVcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBwcm9kdWN0U2V0LmFkZChwcm9kdWN0Lm9iamVjdElEKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gS2VlcCB1bmlxdWVcclxuICAgICAgfVxyXG4gICAgfSkubWFwKHByb2R1Y3QgPT4gKHtcclxuICAgICAgb2JqZWN0SUQ6IHByb2R1Y3Qub2JqZWN0SUQgfHwgJ1Vua25vd24nLFxyXG4gICAgICBuYW1lOiBwcm9kdWN0Lm5hbWUgfHwgJ1Vua25vd24nLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcHJvZHVjdC5kZXNjcmlwdGlvbiB8fCAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJyxcclxuICAgICAgYnJhbmQ6IHByb2R1Y3QuYnJhbmQgfHwgJ1Vua25vd24gYnJhbmQnLFxyXG4gICAgICBjYXRlZ29yaWVzOiBwcm9kdWN0LmNhdGVnb3JpZXMgfHwgW10sXHJcbiAgICAgIGhpZXJhcmNoaWNhbENhdGVnb3JpZXM6IHtcclxuICAgICAgICBsdmwwOiBwcm9kdWN0LmhpZXJhcmNoaWNhbENhdGVnb3JpZXM/Lmx2bDAgfHwgJ1Vua25vd24nLFxyXG4gICAgICAgIGx2bDE6IHByb2R1Y3QuaGllcmFyY2hpY2FsQ2F0ZWdvcmllcz8ubHZsMSB8fCAnVW5rbm93bicsXHJcbiAgICAgICAgbHZsMjogcHJvZHVjdC5oaWVyYXJjaGljYWxDYXRlZ29yaWVzPy5sdmwyIHx8ICdVbmtub3duJyxcclxuICAgICAgICBsdmwzOiBwcm9kdWN0LmhpZXJhcmNoaWNhbENhdGVnb3JpZXM/Lmx2bDMgfHwgJ1Vua25vd24nLFxyXG4gICAgICB9LFxyXG4gICAgICB0eXBlOiBwcm9kdWN0LnR5cGUgfHwgJ1Vua25vd24gdHlwZScsXHJcbiAgICAgIHByaWNlOiBwcm9kdWN0LnByaWNlIHx8IDAsXHJcbiAgICAgIHByaWNlX3JhbmdlOiBwcm9kdWN0LnByaWNlX3JhbmdlIHx8ICdVbmtub3duJyxcclxuICAgICAgaW1hZ2U6IHByb2R1Y3QuaW1hZ2UgfHwgJ05vIGltYWdlIGF2YWlsYWJsZScsXHJcbiAgICAgIHVybDogcHJvZHVjdC51cmwgfHwgJ05vIFVSTCBhdmFpbGFibGUnLFxyXG4gICAgICBmcmVlX3NoaXBwaW5nOiBwcm9kdWN0LmZyZWVfc2hpcHBpbmcgIT09IHVuZGVmaW5lZCA/IHByb2R1Y3QuZnJlZV9zaGlwcGluZyA6IGZhbHNlLFxyXG4gICAgICBwb3B1bGFyaXR5OiBwcm9kdWN0LnBvcHVsYXJpdHkgfHwgMCxcclxuICAgICAgcmF0aW5nOiBwcm9kdWN0LnJhdGluZyB8fCAwLFxyXG4gICAgfSkpO1xyXG5cclxuICAgIC8vIFJlbW92ZSBkdXBsaWNhdGUgb3JkZXJzXHJcbiAgICBjb25zdCBvcmRlclNldCA9IG5ldyBTZXQoKTtcclxuICAgIGNvbnN0IGNsZWFuT3JkZXJzID0gYWxsT3JkZXJzLmZpbHRlcihvcmRlciA9PiB7XHJcbiAgICAgIGlmIChvcmRlclNldC5oYXMob3JkZXIub3JkZXJfaWQpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBTa2lwIGR1cGxpY2F0ZVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG9yZGVyU2V0LmFkZChvcmRlci5vcmRlcl9pZCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIEtlZXAgdW5pcXVlXHJcbiAgICAgIH1cclxuICAgIH0pLm1hcChvcmRlciA9PiAoe1xyXG4gICAgICAuLi5vcmRlcixcclxuICAgICAgcXVhbnRpdHk6IG9yZGVyLnF1YW50aXR5IHx8IDEsXHJcbiAgICAgIHByaWNlX01SUDogb3JkZXIucHJpY2VfTVJQIHx8IDAsXHJcbiAgICAgIHBheW1lbnQ6IG9yZGVyLnBheW1lbnQgfHwgMCxcclxuICAgICAgcmF0aW5nOiBvcmRlci5yYXRpbmcgfHwgMCxcclxuICAgIH0pKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnV3JpdGluZyBjbGVhbmVkIGRhdGEgdG8gZmlsZXMnKTtcclxuICAgIGZzLndyaXRlRmlsZVN5bmMocGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdwdWJsaWMnLCAncHJvZHVjdHMuanNvbicpLCBKU09OLnN0cmluZ2lmeShjbGVhblByb2R1Y3RzKSk7XHJcbiAgICBmcy53cml0ZUZpbGVTeW5jKHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljJywgJ29yZGVycy5qc29uJyksIEpTT04uc3RyaW5naWZ5KGNsZWFuT3JkZXJzKSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0ZpbGVzIHdyaXR0ZW4gc3VjY2Vzc2Z1bGx5Jyk7XHJcblxyXG4gICAgLy8gTG9nIGEgc3VtbWFyeSBvZiBvcmRlcnMgZ3JvdXBlZCBieSB5ZWFyXHJcbiAgICBmb3IgKGNvbnN0IHllYXIgb2YgT2JqZWN0LmtleXMob3JkZXJzQnlZZWFyKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgRmlsZSBvcmRlcnMvJHt5ZWFyfS8qIGRvd25sb2FkZWRgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdFVEwgYW5kIGRhdGEgY29tcGlsYXRpb24gcHJvY2VzcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5JyB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIEVUTCBhbmQgZGF0YSBjb21waWxhdGlvbiBwcm9jZXNzOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJTdG9yYWdlIiwicGFyc2UiLCJmcyIsInBhdGgiLCJjb25maWciLCJoYW5kbGVyIiwicmVxIiwicmVzIiwiY29uc29sZSIsImxvZyIsImNyZWRlbnRpYWxzUGF0aCIsImpvaW4iLCJwcm9jZXNzIiwiY3dkIiwiR09PR0xFX0FQUExJQ0FUSU9OX0NSRURFTlRJQUxTIiwiZXhpc3RzU3luYyIsImVycm9yIiwic3RhdHVzIiwianNvbiIsInN0b3JhZ2UiLCJrZXlGaWxlbmFtZSIsImJ1Y2tldCIsIkJVQ0tFVF9OQU1FIiwicHJvZHVjdHMiLCJvcmRlcnNCeVllYXIiLCJmaWxlcyIsImdldEZpbGVzIiwibWFwIiwiZmlsZSIsIm5hbWUiLCJkYXRhIiwiZG93bmxvYWQiLCJpbmNsdWRlcyIsInByb2R1Y3REYXRhIiwiSlNPTiIsInRvU3RyaW5nIiwicHVzaCIsInllYXJNYXRjaCIsIm1hdGNoIiwieWVhciIsInBhcnNlZERhdGEiLCJjb2x1bW5zIiwic2tpcF9lbXB0eV9saW5lcyIsImRlbGltaXRlciIsInJlY29yZCIsImluZGV4Iiwib3JkZXJfaWQiLCJjdXN0b21lcl9pZCIsInF1YW50aXR5IiwicGFyc2VJbnQiLCJyZXBsYWNlIiwicHJpY2VfTVJQIiwicGFyc2VGbG9hdCIsInBheW1lbnQiLCJ0aW1lc3RhbXAiLCJyYXRpbmciLCJwcm9kdWN0X2NhdGVnb3J5IiwicHJvZHVjdF9pZCIsInBheW1lbnRfdHlwZSIsIm9yZGVyX3N0YXR1cyIsInByb2R1Y3Rfd2VpZ2h0X2ciLCJwcm9kdWN0X2xlbmd0aF9jbSIsInByb2R1Y3RfaGVpZ2h0X2NtIiwicHJvZHVjdF93aWR0aF9jbSIsImN1c3RvbWVyX2NpdHkiLCJjdXN0b21lcl9zdGF0ZSIsInNlbGxlcl9pZCIsInNlbGxlcl9jaXR5Iiwic2VsbGVyX3N0YXRlIiwicGF5bWVudF9pbnN0YWxsbWVudHMiLCJwYXJzZUVycm9yIiwibWVzc2FnZSIsImFsbE9yZGVycyIsIk9iamVjdCIsInZhbHVlcyIsImZsYXQiLCJwcm9kdWN0U2V0IiwiU2V0IiwiY2xlYW5Qcm9kdWN0cyIsImZpbHRlciIsInByb2R1Y3QiLCJoYXMiLCJvYmplY3RJRCIsImFkZCIsImRlc2NyaXB0aW9uIiwiYnJhbmQiLCJjYXRlZ29yaWVzIiwiaGllcmFyY2hpY2FsQ2F0ZWdvcmllcyIsImx2bDAiLCJsdmwxIiwibHZsMiIsImx2bDMiLCJ0eXBlIiwicHJpY2UiLCJwcmljZV9yYW5nZSIsImltYWdlIiwidXJsIiwiZnJlZV9zaGlwcGluZyIsInVuZGVmaW5lZCIsInBvcHVsYXJpdHkiLCJvcmRlclNldCIsImNsZWFuT3JkZXJzIiwib3JkZXIiLCJ3cml0ZUZpbGVTeW5jIiwic3RyaW5naWZ5Iiwia2V5cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/etl.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/etl.js"));
module.exports = __webpack_exports__;

})();